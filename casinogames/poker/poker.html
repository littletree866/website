<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker+</title>
    <link rel="icon" type="image/x-icon" href="../../icon.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Jura:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-green: #18e07c;
            --dark-green: #0d8f4d;
            --table-felt: #0a5c2a;
            --card-red: #d32f2f;
            --card-black: #212121;
            --gold: #ffd700;
            --silver: #c0c0c0;
            --background: #0a1f0a;
            --text-light: #f0f0f0;
            --shadow: rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Jura', sans-serif;
            background: var(--background);
            color: var(--text-light);
            text-align: center;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(10, 95, 42, 0.2) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(24, 224, 124, 0.1) 0%, transparent 20%);
        }

        h1 {
            color: var(--primary-green);
            font-size: 48px;
            font-weight: 700;
            margin: 15px 0;
            text-shadow: 0 0 15px rgba(24, 224, 124, 0.5);
            letter-spacing: 2px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 1000px;
            margin-bottom: 25px;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 12px;
            border: 2px solid var(--primary-green);
            box-shadow: 0 5px 15px var(--shadow);
        }

        .bank-display {
            font-size: 22px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chip-count {
            color: var(--gold);
            font-size: 26px;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
        }

        .pot-display {
            color: var(--primary-green);
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bet-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .bet-btn {
            padding: 8px 16px;
            background: rgba(24, 224, 124, 0.2);
            border: 1px solid var(--primary-green);
            border-radius: 6px;
            color: var(--primary-green);
            font-family: 'Jura', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .bet-btn:hover {
            background: rgba(24, 224, 124, 0.4);
            transform: scale(1.05);
        }

        .bet-btn.active {
            background: var(--primary-green);
            color: var(--background);
        }

        .game-area {
            width: 100%;
            max-width: 1000px;
            background: var(--table-felt);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 
                0 0 30px rgba(0, 0, 0, 0.7),
                inset 0 0 50px rgba(0, 0, 0, 0.3);
            border: 8px solid #5d4037;
            position: relative;
        }

        .game-area::before {
            content: "";
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            pointer-events: none;
        }

        .player-area {
            margin: 25px 0;
            padding: 20px;
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.3);
        }

        .section-title {
            color: var(--gold);
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 15px;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .hand-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            min-height: 120px;
            margin-bottom: 10px;
        }

        .card {
            width: 90px;
            height: 130px;
            background: white;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 28px;
            font-weight: 700;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.2);
        }

        .card.red {
            color: var(--card-red);
        }

        .card.black {
            color: var(--card-black);
        }

        .card-suit {
            font-size: 36px;
            margin-top: 5px;
        }

        .hidden {
            background: linear-gradient(135deg, #333, #111);
            color: transparent;
            position: relative;
            overflow: hidden;
        }

        .hidden::before {
            content: "?";
            position: absolute;
            color: rgba(255, 255, 255, 0.7);
            font-size: 40px;
            font-weight: 700;
        }

        .table-cards {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 30px 0;
            padding: 25px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .hand-strength {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-green);
            margin-top: 10px;
            min-height: 25px;
        }

        .game-stage {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        .stage-indicator {
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }

        .stage-indicator.active {
            background: var(--primary-green);
            color: var(--background);
            box-shadow: 0 0 15px rgba(24, 224, 124, 0.5);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .game-btn {
            padding: 15px 30px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Jura', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 150px;
        }

        .game-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .game-btn:active:not(:disabled) {
            transform: translateY(-1px);
        }

        .game-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        #betBtn {
            background: var(--primary-green);
            color: var(--background);
        }

        #callBtn {
            background: #2196f3;
            color: white;
        }

        #raiseBtn {
            background: #ff9800;
            color: white;
        }

        #foldBtn {
            background: #f44336;
            color: white;
        }

        #checkBtn {
            background: #9c27b0;
            color: white;
        }

        #newGameBtn {
            background: var(--gold);
            color: var(--background);
            display: none;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 1000px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            font-size: 16px;
        }

        .accessibility-bar {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .accessibility-btn {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--primary-green);
            border-radius: 6px;
            color: var(--primary-green);
            font-family: 'Jura', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .accessibility-btn:hover {
            background: rgba(24, 224, 124, 0.1);
        }

        .result-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .result-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .result-content {
            background: var(--background);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 3px solid var(--primary-green);
            box-shadow: 0 0 30px rgba(24, 224, 124, 0.3);
        }

        .result-title {
            font-size: 36px;
            margin-bottom: 20px;
            color: var(--primary-green);
        }

        .result-details {
            font-size: 20px;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .hand-comparison {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .hand-name {
            font-size: 24px;
            font-weight: 700;
            color: var(--gold);
            margin-top: 10px;
        }

        .winning-hand {
            color: var(--primary-green);
            text-shadow: 0 0 10px rgba(24, 224, 124, 0.5);
        }

        /* Animations */
        @keyframes dealCard {
            0% { transform: translateY(-50px) rotate(-10deg); opacity: 0; }
            100% { transform: translateY(0) rotate(0); opacity: 1; }
        }

        .card-dealing {
            animation: dealCard 0.5s ease-out;
        }

        @keyframes chipPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .chip-pulse {
            animation: chipPulse 0.5s ease-in-out;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            h1 { font-size: 36px; }
            .game-header { flex-direction: column; gap: 15px; }
            .card { width: 70px; height: 105px; font-size: 22px; }
            .card-suit { font-size: 28px; }
            .game-btn { min-width: 130px; padding: 12px 20px; }
            .controls { gap: 10px; }
            .game-stage { flex-wrap: wrap; }
        }

        @media (max-width: 480px) {
            .card { width: 60px; height: 90px; font-size: 20px; }
            .card-suit { font-size: 24px; }
            .game-btn { min-width: 120px; padding: 10px 15px; font-size: 16px; }
            .section-title { font-size: 20px; }
        }
    </style>
</head>
<body>
    <h1><i class="fas fa-diamond"></i> POKER PRO <i class="fas fa-club"></i></h1>
    
    <div class="game-header">
        <div class="bank-display">
            <i class="fas fa-coins"></i>
            Your Chips: <span id="bank" class="chip-count">1000</span>
        </div>
        
        <div class="pot-display">
            <i class="fas fa-gem"></i>
            Pot: <span id="pot">0</span>
        </div>
        
        <div>
            <div>Current Bet: <span id="currentBet">100</span></div>
            <div class="bet-options">
                <button class="bet-btn active" data-bet="100">100</button>
                <button class="bet-btn" data-bet="250">250</button>
                <button class="bet-btn" data-bet="500">500</button>
            </div>
        </div>
    </div>
    
    <div class="game-area">
        <div class="player-area">
            <div class="section-title">
                <i class="fas fa-robot"></i> Dealer
            </div>
            <div id="dealer" class="hand-container"></div>
            <div id="dealerHand" class="hand-strength"></div>
        </div>
        
        <div class="table-cards">
            <div id="table"></div>
        </div>
        
        <div class="player-area">
            <div class="section-title">
                <i class="fas fa-user"></i> You
            </div>
            <div id="player" class="hand-container"></div>
            <div id="playerHand" class="hand-strength"></div>
        </div>
        
        <div class="game-stage">
            <div class="stage-indicator" id="stage1">Pre-Flop</div>
            <div class="stage-indicator" id="stage2">Flop</div>
            <div class="stage-indicator" id="stage3">Turn</div>
            <div class="stage-indicator" id="stage4">River</div>
            <div class="stage-indicator" id="stage5">Showdown</div>
        </div>
    </div>
    
    <div class="controls">
        <button id="betBtn" class="game-btn">
            <i class="fas fa-money-bill-wave"></i> Bet
        </button>
        <button id="callBtn" class="game-btn">
            <i class="fas fa-handshake"></i> Call
        </button>
        <button id="raiseBtn" class="game-btn">
            <i class="fas fa-angle-double-up"></i> Raise
        </button>
        <button id="checkBtn" class="game-btn">
            <i class="fas fa-check-circle"></i> Check
        </button>
        <button id="foldBtn" class="game-btn">
            <i class="fas fa-times-circle"></i> Fold
        </button>
        <button id="newGameBtn" class="game-btn">
            <i class="fas fa-redo"></i> New Game
        </button>
    </div>
    
    <div class="game-info">
        <div>Cards in deck: <span id="deckCount">52</span></div>
        <div>Games played: <span id="gamesPlayed">0</span></div>
        <div>Win rate: <span id="winRate">0%</span></div>
    </div>
    
    <div class="accessibility-bar">
        <button id="helpBtn" class="accessibility-btn">
            <i class="fas fa-question-circle"></i> Help
        </button>
        <button id="hintBtn" class="accessibility-btn">
            <i class="fas fa-lightbulb"></i> Hint
        </button>
        <button id="soundToggle" class="accessibility-btn">
            <i class="fas fa-volume-up"></i> Sound
        </button>
    </div>
    
    <div id="resultModal" class="result-modal">
        <div class="result-content">
            <div class="result-title" id="resultTitle">Result</div>
            <div class="result-details" id="resultDetails"></div>
            <div class="hand-comparison">
                <div>
                    <div>Your Hand</div>
                    <div id="playerResultHand"></div>
                    <div class="hand-name" id="playerHandName"></div>
                </div>
                <div>
                    <div>Dealer's Hand</div>
                    <div id="dealerResultHand"></div>
                    <div class="hand-name" id="dealerHandName"></div>
                </div>
            </div>
            <button id="closeResult" class="game-btn" style="background: var(--primary-green); margin-top: 20px;">
                Continue
            </button>
        </div>
    </div>

    <script>
        // Game variables
        let deck = [];
        let player = [];
        let dealer = [];
        let table = [];
        let bank = 1000;
        let pot = 0;
        let currentBet = 100;
        let stage = 0;
        let gamesPlayed = 0;
        let gamesWon = 0;
        let soundEnabled = true;
        
        // Poker hand rankings
        const handRankings = [
            "High Card", "One Pair", "Two Pair", "Three of a Kind", 
            "Straight", "Flush", "Full House", "Four of a Kind", 
            "Straight Flush", "Royal Flush"
        ];
        
        // Initialize game
        function initGame() {
            updateUI();
            setupEventListeners();
            startNewGame();
        }
        
        function startNewGame() {
            // Reset game state
            stage = 0;
            pot = 0;
            player = [];
            dealer = [];
            table = [];
            
            // Create and shuffle deck
            deck = createDeck();
            shuffleDeck(deck);
            
            // Deal initial cards
            player = drawCards(2);
            dealer = drawCards(2);
            
            // Update UI
            updateStageIndicator();
            renderCards();
            updateUI();
            
            // Enable/disable buttons
            updateButtonStates();
            
            // Show game stage info
            updateHandStrengths();
        }
        
        function createDeck() {
            const suits = ["♠", "♥", "♦", "♣"];
            const values = ["2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K", "A"];
            let newDeck = [];
            
            for (let suit of suits) {
                for (let value of values) {
                    const color = (suit === "♥" || suit === "♦") ? "red" : "black";
                    newDeck.push({
                        value: value,
                        suit: suit,
                        color: color,
                        code: value + suit
                    });
                }
            }
            
            return newDeck;
        }
        
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }
        
        function drawCards(n) {
            return deck.splice(0, n);
        }
        
        function renderCards() {
            // Render player cards
            const playerDiv = document.getElementById("player");
            playerDiv.innerHTML = "";
            player.forEach((card, index) => {
                const cardElement = createCardElement(card);
                if (index === player.length - 1) {
                    cardElement.classList.add("card-dealing");
                }
                playerDiv.appendChild(cardElement);
            });
            
            // Render dealer cards
            const dealerDiv = document.getElementById("dealer");
            dealerDiv.innerHTML = "";
            dealer.forEach((card, index) => {
                const cardElement = createCardElement(card, stage < 4);
                if (index === dealer.length - 1) {
                    cardElement.classList.add("card-dealing");
                }
                dealerDiv.appendChild(cardElement);
            });
            
            // Render table cards
            const tableDiv = document.getElementById("table");
            tableDiv.innerHTML = "";
            table.forEach((card, index) => {
                const cardElement = createCardElement(card);
                if (index >= table.length - (stage === 1 ? 3 : 1)) {
                    cardElement.classList.add("card-dealing");
                }
                tableDiv.appendChild(cardElement);
            });
        }
        
        function createCardElement(card, hidden = false) {
            const div = document.createElement("div");
            div.className = `card ${card.color}`;
            
            if (hidden) {
                div.classList.add("hidden");
            } else {
                div.innerHTML = `
                    <div>${card.value}</div>
                    <div class="card-suit">${card.suit}</div>
                `;
            }
            
            return div;
        }
        
        function updateUI() {
            document.getElementById("bank").textContent = bank;
            document.getElementById("pot").textContent = pot;
            document.getElementById("currentBet").textContent = currentBet;
            document.getElementById("deckCount").textContent = deck.length;
            document.getElementById("gamesPlayed").textContent = gamesPlayed;
            
            // Calculate win rate
            const winRate = gamesPlayed > 0 ? Math.round((gamesWon / gamesPlayed) * 100) : 0;
            document.getElementById("winRate").textContent = winRate + "%";
        }
        
        function updateStageIndicator() {
            // Reset all indicators
            for (let i = 1; i <= 5; i++) {
                const indicator = document.getElementById(`stage${i}`);
                indicator.classList.remove("active");
            }
            
            // Activate current stage
            if (stage >= 0 && stage <= 4) {
                const currentIndicator = document.getElementById(`stage${stage + 1}`);
                if (currentIndicator) currentIndicator.classList.add("active");
            }
        }
        
        function updateButtonStates() {
            const betBtn = document.getElementById("betBtn");
            const callBtn = document.getElementById("callBtn");
            const raiseBtn = document.getElementById("raiseBtn");
            const checkBtn = document.getElementById("checkBtn");
            const foldBtn = document.getElementById("foldBtn");
            const newGameBtn = document.getElementById("newGameBtn");
            
            // In early stages, show bet/call/check/fold
            if (stage === 0) {
                betBtn.style.display = "flex";
                callBtn.style.display = "none";
                raiseBtn.style.display = "none";
                checkBtn.style.display = "flex";
                foldBtn.style.display = "flex";
                newGameBtn.style.display = "none";
                
                // Disable bet if insufficient funds
                betBtn.disabled = bank < currentBet;
                checkBtn.disabled = false;
            } 
            // In later stages, show call/raise/check/fold
            else if (stage < 4) {
                betBtn.style.display = "none";
                callBtn.style.display = "flex";
                raiseBtn.style.display = "flex";
                checkBtn.style.display = "flex";
                foldBtn.style.display = "flex";
                newGameBtn.style.display = "none";
                
                // Disable raise if insufficient funds
                raiseBtn.disabled = bank < currentBet;
            }
            // After showdown, show new game button
            else if (stage === 4) {
                betBtn.style.display = "none";
                callBtn.style.display = "none";
                raiseBtn.style.display = "none";
                checkBtn.style.display = "none";
                foldBtn.style.display = "none";
                newGameBtn.style.display = "flex";
            }
        }
        
        // Game actions
        function bet() {
            if (bank < currentBet) return;
            
            bank -= currentBet;
            pot += currentBet * 2; // Assuming dealer matches bet
            
            playSound("chip");
            nextStage();
        }
        
        function call() {
            if (bank < currentBet) {
                alert("Not enough chips to call!");
                return;
            }
            
            bank -= currentBet;
            pot += currentBet;
            
            playSound("chip");
            nextStage();
        }
        
        function raise() {
            const raiseAmount = currentBet * 2;
            
            if (bank < raiseAmount) {
                alert("Not enough chips to raise!");
                return;
            }
            
            bank -= raiseAmount;
            pot += raiseAmount;
            currentBet = raiseAmount;
            
            playSound("chip");
            nextStage();
        }
        
        function check() {
            playSound("card");
            nextStage();
        }
        
        function fold() {
            showResult("You folded.", "You forfeit the pot to the dealer.", false);
            playSound("fold");
            
            // Update game stats
            gamesPlayed++;
            updateUI();
            
            stage = 4;
            updateStageIndicator();
            updateButtonStates();
        }
        
        function nextStage() {
            stage++;
            
            // Deal community cards based on stage
            if (stage === 1) {
                table = drawCards(3); // Flop
                playSound("deal");
            } else if (stage === 2) {
                table.push(...drawCards(1)); // Turn
                playSound("deal");
            } else if (stage === 3) {
                table.push(...drawCards(1)); // River
                playSound("deal");
            } else if (stage === 4) {
                showdown();
                return;
            }
            
            updateStageIndicator();
            renderCards();
            updateUI();
            updateButtonStates();
            updateHandStrengths();
        }
        
        function updateHandStrengths() {
            if (stage === 0) return;
            
            const playerStrength = evaluateHand([...player, ...table]);
            const dealerStrength = evaluateHand([...dealer, ...table]);
            
            document.getElementById("playerHand").textContent = 
                `Hand: ${handRankings[playerStrength.rank]}`;
            document.getElementById("dealerHand").textContent = 
                stage < 4 ? "Hand: ???" : `Hand: ${handRankings[dealerStrength.rank]}`;
        }
        
        function showdown() {
            const playerStrength = evaluateHand([...player, ...table]);
            const dealerStrength = evaluateHand([...dealer, ...table]);
            
            // Compare hands
            let playerWins = false;
            let tie = false;
            
            if (playerStrength.rank > dealerStrength.rank) {
                playerWins = true;
            } else if (playerStrength.rank === dealerStrength.rank) {
                // Same hand rank, compare high cards
                if (playerStrength.score > dealerStrength.score) {
                    playerWins = true;
                } else if (playerStrength.score === dealerStrength.score) {
                    tie = true;
                }
            }
            
            // Update bank
            if (playerWins) {
                bank += pot;
                gamesWon++;
                showResult(
                    "You Win!", 
                    `You win ${pot} chips with ${handRankings[playerStrength.rank]}!`,
                    true
                );
                playSound("win");
            } else if (tie) {
                bank += pot / 2;
                showResult(
                    "It's a Tie!", 
                    `You split the pot with the dealer. Both have ${handRankings[playerStrength.rank]}.`,
                    false
                );
                playSound("push");
            } else {
                showResult(
                    "Dealer Wins!", 
                    `Dealer wins with ${handRankings[dealerStrength.rank]}.`,
                    false
                );
                playSound("lose");
            }
            
            // Update game stats
            gamesPlayed++;
            updateUI();
            
            // Show both hands
            renderCards();
            
            // Update hand display in result modal
            document.getElementById("playerResultHand").innerHTML = 
                player.map(c => c.code).join(" ") + " + " + table.map(c => c.code).join(" ");
            document.getElementById("dealerResultHand").innerHTML = 
                dealer.map(c => c.code).join(" ") + " + " + table.map(c => c.code).join(" ");
            
            document.getElementById("playerHandName").textContent = handRankings[playerStrength.rank];
            document.getElementById("dealerHandName").textContent = handRankings[dealerStrength.rank];
            
            // Highlight winning hand
            if (playerWins) {
                document.getElementById("playerHandName").classList.add("winning-hand");
            } else if (!tie) {
                document.getElementById("dealerHandName").classList.add("winning-hand");
            }
            
            updateButtonStates();
        }
        
        // Poker hand evaluation (simplified)
        function evaluateHand(cards) {
            // This is a simplified evaluator - a full poker hand evaluator would be more complex
            const values = cards.map(c => c.value);
            const suits = cards.map(c => c.suit);
            
            // Count value occurrences
            const valueCount = {};
            values.forEach(v => valueCount[v] = (valueCount[v] || 0) + 1);
            
            // Count suit occurrences
            const suitCount = {};
            suits.forEach(s => suitCount[s] = (suitCount[s] || 0) + 1);
            
            // Check for flush
            const flush = Object.values(suitCount).some(count => count >= 5);
            
            // Convert values to numerical scores
            const valueScores = {
                '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7, 
                '8': 8, '9': 9, '10': 10, 'J': 11, 'Q': 12, 'K': 13, 'A': 14
            };
            
            const numValues = values.map(v => valueScores[v]).sort((a, b) => a - b);
            
            // Check for straight
            let straight = false;
            let straightHigh = 0;
            if (numValues.length >= 5) {
                for (let i = 0; i <= numValues.length - 5; i++) {
                    if (numValues[i+4] - numValues[i] === 4) {
                        straight = true;
                        straightHigh = numValues[i+4];
                        break;
                    }
                }
            }
            
            // Determine hand rank
            const pairs = Object.values(valueCount).filter(count => count === 2).length;
            const threeKind = Object.values(valueCount).some(count => count === 3);
            const fourKind = Object.values(valueCount).some(count => count === 4);
            const fullHouse = threeKind && pairs >= 1;
            
            let rank = 0; // High card by default
            let score = Math.max(...numValues);
            
            if (straight && flush && straightHigh === 14) {
                rank = 9; // Royal flush
                score = 1000;
            } else if (straight && flush) {
                rank = 8; // Straight flush
                score = 900 + straightHigh;
            } else if (fourKind) {
                rank = 7; // Four of a kind
                score = 800;
            } else if (fullHouse) {
                rank = 6; // Full house
                score = 700;
            } else if (flush) {
                rank = 5; // Flush
                score = 600;
            } else if (straight) {
                rank = 4; // Straight
                score = 500 + straightHigh;
            } else if (threeKind) {
                rank = 3; // Three of a kind
                score = 400;
            } else if (pairs === 2) {
                rank = 2; // Two pair
                score = 300;
            } else if (pairs === 1) {
                rank = 1; // One pair
                score = 200;
            }
            
            return { rank, score };
        }
        
        function showResult(title, details, isWin) {
            document.getElementById("resultTitle").textContent = title;
            document.getElementById("resultDetails").textContent = details;
            
            if (isWin) {
                document.getElementById("resultTitle").style.color = "var(--primary-green)";
            } else if (title.includes("Tie")) {
                document.getElementById("resultTitle").style.color = "var(--gold)";
            } else {
                document.getElementById("resultTitle").style.color = "#f44336";
            }
            
            document.getElementById("resultModal").classList.add("show");
        }
        
        function playSound(type) {
            if (!soundEnabled) return;
            
            // In a real implementation, you would play actual audio files
            console.log(`Playing sound: ${type}`);
            
            // Example sound implementation (would need audio files)
            // const audio = new Audio(`sounds/${type}.mp3`);
            // audio.volume = 0.5;
            // audio.play().catch(e => console.log("Audio play failed:", e));
        }
        
        function setupEventListeners() {
            // Game action buttons
            document.getElementById("betBtn").addEventListener("click", bet);
            document.getElementById("callBtn").addEventListener("click", call);
            document.getElementById("raiseBtn").addEventListener("click", raise);
            document.getElementById("checkBtn").addEventListener("click", check);
            document.getElementById("foldBtn").addEventListener("click", fold);
            document.getElementById("newGameBtn").addEventListener("click", startNewGame);
            document.getElementById("closeResult").addEventListener("click", () => {
                document.getElementById("resultModal").classList.remove("show");
            });
            
            // Bet amount buttons
            document.querySelectorAll(".bet-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    // Remove active class from all bet buttons
                    document.querySelectorAll(".bet-btn").forEach(b => b.classList.remove("active"));
                    
                    // Add active class to clicked button
                    this.classList.add("active");
                    
                    // Update current bet
                    currentBet = parseInt(this.dataset.bet);
                    updateUI();
                    playSound("chip");
                });
            });
            
            // Accessibility buttons
            document.getElementById("helpBtn").addEventListener("click", () => {
                alert("POKER RULES:\n\n• Try to make the best 5-card hand using your 2 cards and the 5 community cards.\n• Betting rounds: Pre-flop, Flop (3 cards), Turn (1 card), River (1 card).\n• You can Bet, Call, Raise, Check, or Fold.\n• Hand rankings (high to low): Royal Flush, Straight Flush, Four of a Kind, Full House, Flush, Straight, Three of a Kind, Two Pair, One Pair, High Card.");
                playSound("click");
            });
            
            document.getElementById("hintBtn").addEventListener("click", () => {
                if (stage === 0) {
                    alert("Hint: Consider betting strong hands like high pairs or high cards.");
                } else {
                    const playerStrength = evaluateHand([...player, ...table]);
                    alert(`Your current hand strength: ${handRankings[playerStrength.rank]}\n${getHint(playerStrength.rank)}`);
                }
                playSound("click");
            });
            
            document.getElementById("soundToggle").addEventListener("click", () => {
                soundEnabled = !soundEnabled;
                const icon = document.querySelector("#soundToggle i");
                icon.className = soundEnabled ? "fas fa-volume-up" : "fas fa-volume-mute";
                playSound("click");
            });
            
            // Keyboard shortcuts
            document.addEventListener("keydown", (e) => {
                if (document.getElementById("resultModal").classList.contains("show")) {
                    if (e.key === "Enter" || e.key === "Escape") {
                        document.getElementById("closeResult").click();
                    }
                    return;
                }
                
                switch(e.key.toLowerCase()) {
                    case "b": document.getElementById("betBtn").click(); break;
                    case "c": document.getElementById("callBtn").click(); break;
                    case "r": document.getElementById("raiseBtn").click(); break;
                    case "k": document.getElementById("checkBtn").click(); break;
                    case "f": document.getElementById("foldBtn").click(); break;
                    case "n": document.getElementById("newGameBtn").click(); break;
                    case "1": document.querySelector('.bet-btn[data-bet="100"]').click(); break;
                    case "2": document.querySelector('.bet-btn[data-bet="250"]').click(); break;
                    case "3": document.querySelector('.bet-btn[data-bet="500"]').click(); break;
                }
            });
            
            // Prevent spacebar from scrolling page
            document.addEventListener('keydown', function(e) {
                if(e.key === ' ' && e.target === document.body) {
                    e.preventDefault();
                }
            });
        }
        
        function getHint(handRank) {
            const hints = [
                "High Card: Consider folding unless you have high cards.",
                "One Pair: Worth betting if it's a high pair.",
                "Two Pair: Strong hand, consider raising.",
                "Three of a Kind: Very strong, bet aggressively.",
                "Straight: Strong hand, bet or raise.",
                "Flush: Very strong, bet aggressively.",
                "Full House: Excellent hand, raise maximum.",
                "Four of a Kind: Near unbeatable, raise maximum.",
                "Straight Flush: Almost unbeatable, raise maximum.",
                "Royal Flush: Unbeatable, raise maximum!"
            ];
            return hints[handRank] || "Play cautiously.";
        }
        
        // Initialize the game when page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>