<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wealth Builder</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="../../icon.jpg" type="image/x-icon">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jura:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --secondary-gradient: linear-gradient(to bottom right, #f093fb 0%, #f5576c 100%);
      --accent-green: #10b981;
      --accent-blue: #3b82f6;
      --accent-gold: #f59e0b;
      --accent-red: #ef4444;
      --accent-purple: #8b5cf6;
      --card-bg: rgba(255, 255, 255, 0.95);
      --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --hover-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --danger-color: #ef4444;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Jura', sans-serif;
      background: var(--primary-gradient);
      color: var(--text-primary);
      min-height: 100vh;
      margin: 0;
      padding: 30px 20px;
      overflow-x: hidden;
    }

    /* Animated background elements */
    .bg-particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    .bg-particle {
      position: absolute;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: float 20s infinite linear;
    }

    @keyframes float {
      0% {
        transform: translateY(100vh) rotate(0deg);
      }
      100% {
        transform: translateY(-100px) rotate(360deg);
      }
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .main-card {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 24px;
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
      margin-bottom: 30px;
    }

    .main-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(90deg, var(--accent-green), var(--accent-blue), var(--accent-gold));
    }

    .stats-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid rgba(0, 0, 0, 0.05);
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 5px;
    }

    .subtitle {
      color: var(--text-secondary);
      font-size: 1rem;
      margin-bottom: 10px;
    }

    #money {
      font-family: 'Jura', monospace;
      font-size: 2.8rem;
      font-weight: 700;
      color: var(--accent-green);
      text-shadow: 0 2px 10px rgba(16, 185, 129, 0.2);
      animation: money-pulse 3s infinite;
    }

    @keyframes money-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .income-display {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
      padding: 15px;
      border-radius: 16px;
      margin-bottom: 25px;
      text-align: center;
    }

    .income-display h3 {
      color: var(--accent-green);
      margin-bottom: 8px;
      font-size: 1.2rem;
      font-weight: 600;
    }

    #incomePerSec {
      font-family: 'Jura', monospace;
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .action-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .btn {
      padding: 16px 20px;
      border: none;
      border-radius: 14px;
      font-family: 'Jura', sans-serif;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 5px;
      position: relative;
      overflow: hidden;
      min-height: 80px;
    }

    .btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .btn:hover::after {
      width: 300px;
      height: 300px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
      color: white;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, var(--accent-green), #34d399);
      color: white;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
    }

    .btn-success:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
    }

    .btn-warning {
      background: linear-gradient(135deg, var(--accent-gold), #fbbf24);
      color: white;
      box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
    }

    .btn-warning:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
    }

    .btn-danger {
      background: linear-gradient(135deg, var(--accent-red), #f87171);
      color: white;
      box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
    }

    .btn-danger:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
    }

    .btn:disabled {
      background: linear-gradient(135deg, #9ca3af, #6b7280);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn:disabled:hover {
      transform: none;
      box-shadow: none;
    }

    .btn-cooldown {
      font-size: 0.85rem;
      font-weight: 500;
      opacity: 0.9;
    }

    .opportunities-section {
      margin-top: 25px;
      padding: 20px;
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.05), rgba(59, 130, 246, 0.05));
      border-radius: 18px;
      border: 1px solid rgba(139, 92, 246, 0.1);
    }

    .opportunities-section h3 {
      color: var(--accent-purple);
      margin-bottom: 15px;
      font-size: 1.3rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .opportunities-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    /* Four panel grid layout */
    .panels-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 20px;
    }

    .panel {
      background: var(--card-bg);
      padding: 25px;
      border-radius: 20px;
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: block;
      max-height: 500px;
      overflow-y: auto;
      transition: all 0.3s;
    }

    .panel:hover {
      transform: translateY(-5px);
      box-shadow: var(--hover-shadow);
    }

    .panel h3 {
      color: var(--accent-blue);
      margin-bottom: 15px;
      font-size: 1.4rem;
      font-weight: 600;
      padding-bottom: 10px;
      border-bottom: 2px solid rgba(59, 130, 246, 0.1);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .grid {
      display: grid;
      gap: 15px;
      margin-top: 15px;
    }

    .grid-item {
      background: rgba(255, 255, 255, 0.7);
      padding: 18px;
      border-radius: 14px;
      border: 1px solid rgba(0, 0, 0, 0.05);
      transition: all 0.3s;
    }

    .grid-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
      border-color: var(--accent-blue);
    }

    .grid-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .grid-name {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 1.1rem;
    }

    .grid-price {
      font-family: 'Jura', monospace;
      font-weight: 600;
      color: var(--accent-green);
      font-size: 1.1rem;
    }

    .grid-details {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-size: 0.95rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .grid-actions {
      margin-top: 15px;
      display: flex;
      gap: 10px;
    }

    .small-btn {
      padding: 8px 16px;
      border-radius: 10px;
      font-size: 0.95rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      flex: 1;
      font-family: 'Jura', sans-serif;
    }

    .buy-btn {
      background: var(--accent-green);
      color: white;
    }

    .buy-btn:hover:not(:disabled) {
      background: #0da271;
      transform: translateY(-2px);
    }

    .sell-btn {
      background: var(--accent-red);
      color: white;
    }

    .sell-btn:hover:not(:disabled) {
      background: #dc2626;
      transform: translateY(-2px);
    }

    .small-btn:disabled {
      background: #9ca3af;
      cursor: not-allowed;
      transform: none;
    }

    #message {
      min-height: 24px;
      font-weight: 600;
      margin-top: 15px;
      padding: 12px;
      border-radius: 12px;
      text-align: center;
      transition: all 0.3s;
      opacity: 0;
      transform: translateY(-10px);
      font-size: 1rem;
    }

    .message-success {
      background: rgba(16, 185, 129, 0.1);
      color: var(--accent-green);
      opacity: 1;
      transform: translateY(0);
      border: 1px solid rgba(16, 185, 129, 0.2);
    }

    .message-error {
      background: rgba(239, 68, 68, 0.1);
      color: var(--accent-red);
      opacity: 1;
      transform: translateY(0);
      border: 1px solid rgba(239, 68, 68, 0.2);
    }

    .message-info {
      background: rgba(59, 130, 246, 0.1);
      color: var(--accent-blue);
      opacity: 1;
      transform: translateY(0);
      border: 1px solid rgba(59, 130, 246, 0.2);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(0, 0, 0, 0.1);
      border-radius: 4px;
      margin-top: 10px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
      border-radius: 4px;
      width: 0%;
      transition: width 0.3s;
    }

    /* Task area styling */
    #taskArea {
      margin-top: 20px;
      padding: 20px;
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), rgba(234, 179, 8, 0.05));
      border-radius: 16px;
      border: 1px solid rgba(245, 158, 11, 0.1);
    }

    .task-instruction {
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: var(--accent-gold);
      text-align: center;
      font-weight: 600;
    }

    .task-input {
      width: 100%;
      padding: 14px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 1rem;
      font-family: 'Jura', sans-serif;
      font-weight: 500;
      transition: border-color 0.3s;
    }

    .task-input:focus {
      outline: none;
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .task-submit {
      width: 100%;
      margin-top: 15px;
    }

    /* Stats overlay */
    .stats-overlay {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 15px;
      border-radius: 12px;
      font-size: 0.9rem;
      z-index: 1000;
      backdrop-filter: blur(10px);
      font-family: 'Jura', sans-serif;
      font-weight: 500;
    }

    /* Cooldown indicators */
    .cooldown-active {
      position: relative;
    }

    .cooldown-active::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 14px;
    }

    /* Responsive design */
    @media (max-width: 1200px) {
      .panels-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 900px) {
      .panels-grid {
        grid-template-columns: 1fr;
      }
      
      .action-buttons {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .opportunities-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .action-buttons {
        grid-template-columns: 1fr;
      }
      
      .stats-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }
      
      #money {
        font-size: 2.2rem;
      }
      
      h1 {
        font-size: 2rem;
      }
    }

    @media (max-width: 480px) {
      .main-card {
        padding: 20px;
      }
      
      .panel {
        padding: 20px;
      }
      
      .btn {
        padding: 14px 16px;
        font-size: 0.95rem;
      }
    }

    /* Scrollbar styling */
    .panel::-webkit-scrollbar {
      width: 8px;
    }

    .panel::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.05);
      border-radius: 4px;
    }

    .panel::-webkit-scrollbar-thumb {
      background: var(--accent-blue);
      border-radius: 4px;
    }

    .panel::-webkit-scrollbar-thumb:hover {
      background: var(--accent-purple);
    }
  </style>
</head>

<body>
  <!-- Animated background particles -->
  <div class="bg-particles" id="bgParticles"></div>

  <!-- Stats overlay -->
  <div class="stats-overlay">
    <div>Investments: <span id="statsInvestments">0</span></div>
    <div>Startups: <span id="statsStartups">0</span></div>
    <div>Total Income/sec: <span id="statsTotalIncome">$0</span></div>
  </div>

  <div class="container">
    <!-- Main card on top -->
    <div class="main-card">
      <div class="stats-header">
        <div>
          <h1>üí∞ Wealth Builder</h1>
          <div class="subtitle">Build Your Financial Empire ‚Ä¢ v2.0</div>
        </div>
        <div id="money">$1</div>
      </div>

      <div class="income-display">
        <h3>üìà Passive Income</h3>
        <div id="incomePerSec">+$0.00/sec</div>
        <div class="progress-bar">
          <div class="progress-fill" id="incomeProgress"></div>
        </div>
      </div>

      <div class="action-buttons">
        <button id="taskBtn" class="btn btn-primary">
          <span>üíº Do Task</span>
          <span class="btn-cooldown" id="taskCooldown">Ready</span>
        </button>
        <button id="freelanceBtn" class="btn btn-success">
          <span>üéØ Freelance</span>
          <span class="btn-cooldown" id="freelanceCooldown">Ready</span>
        </button>
        <button id="investBtn" class="btn btn-primary" disabled>
          <span>üìä Invest</span>
          <span class="btn-cooldown">$10</span>
        </button>
        <button id="quickTradeBtn" class="btn btn-warning">
          <span>‚ö° Quick Trade</span>
          <span class="btn-cooldown" id="tradeCooldown">Ready</span>
        </button>
      </div>

      <div id="taskArea" style="display: none;">
        <div class="task-instruction" id="taskInstruction">Type the word shown below:</div>
        <input type="text" id="taskInput" class="task-input" placeholder="Type here...">
        <button id="taskSubmit" class="btn btn-success task-submit">Submit Task</button>
      </div>

      <p id="message"></p>

      <div id="opportunities" class="opportunities-section">
        <h3>üåü Growth Opportunities</h3>
        <div class="opportunities-grid">
          <button id="partTimeBtn" class="btn btn-success">
            <span>üïê Part-Time Job</span>
            <span class="btn-cooldown" id="partTimeCooldown">Ready</span>
          </button>
          <button id="stockBtn" class="btn btn-warning">
            <span>üìà Stock Market</span>
            <span class="btn-cooldown" id="stockCooldown">Ready</span>
          </button>
          <button id="consultingBtn" class="btn btn-primary">
            <span>üëî Consulting</span>
            <span class="btn-cooldown" id="consultingCooldown">Ready</span>
          </button>
          <button id="cryptoBtn" class="btn btn-danger">
            <span>‚Çø Crypto Trading</span>
            <span class="btn-cooldown" id="cryptoCooldown">Ready</span>
          </button>
        </div>
      </div>

      <div id="highTierOpportunities" class="opportunities-section" style="display:none;">
        <h3>üíé Premium Ventures</h3>
        <div class="opportunities-grid">
          <button id="startupBtn" class="btn btn-success">
            <span>üöÄ Launch Startup</span>
            <span class="btn-cooldown">$50</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Four panels in a grid below -->
    <div class="panels-grid">
      <div id="marketSection" class="panel">
        <h3>üè™ Market Trading</h3>
        <p style="color: var(--text-secondary); margin-bottom: 15px; font-weight: 500;">Buy low, sell high! Prices change every 10 seconds.</p>
        <div id="marketGrid" class="grid"></div>
      </div>

      <div id="craftingPanel" class="panel">
        <h3>üõ†Ô∏è Crafting Workshop</h3>
        <p style="color: var(--text-secondary); margin-bottom: 15px; font-weight: 500;">Create valuable items from resources</p>
        <div id="recipeGrid" class="grid"></div>
      </div>

      <div id="buildingPanel" class="panel">
        <h3>üèóÔ∏è Business Empire</h3>
        <p style="color: var(--text-secondary); margin-bottom: 15px; font-weight: 500;">Build and manage your enterprises</p>
        <div id="buildingGrid" class="grid"></div>
      </div>

      <div id="investingPanel" class="panel">
        <h3>üíπ Long-term Assets</h3>
        <p style="color: var(--text-secondary); margin-bottom: 15px; font-weight: 500;">Invest in appreciating assets</p>
        <div id="assetGrid" class="grid"></div>
      </div>
    </div>
  </div>

  <script>
    // Enhanced game state with cooldowns
    const state = {
      money: 1,
      investments: 0,
      investmentCost: 10,
      investmentsYieldPerSec: 0.5,
      startups: 0,
      startupCost: 50,
      startupYieldPerSec: 2.5,
      totalIncomePerSec: 0,
      buildings: [
        { name: "Coffee Shop", cost: 500, incomePerMin: 50, owned: 0, description: "A cozy cafe" },
        { name: "Tech Store", cost: 1000, incomePerMin: 100, owned: 0, description: "Electronics retailer" },
        { name: "Restaurant", cost: 2500, incomePerMin: 250, owned: 0, description: "Fine dining establishment" },
        { name: "Hotel Chain", cost: 10000, incomePerMin: 1000, owned: 0, description: "Luxury hospitality" }
      ],
      assets: [
        { name: "Stock Portfolio", cost: 1000, growthPerMin: 0.10, owned: 0, description: "Diverse stock holdings" },
        { name: "Real Estate", cost: 5000, growthPerMin: 0.20, owned: 0, description: "Property investments" },
        { name: "Gold Reserves", cost: 2500, growthPerMin: 0.15, owned: 0, description: "Precious metal storage" },
        { name: "Tech Startup Shares", cost: 10000, growthPerMin: 0.30, owned: 0, description: "High-risk, high-reward" }
      ],
      market: {
        items: [
          { name: "Coffee Beans", basePrice: 15, volatility: 0.3, currentPrice: 15, owned: 0, description: "Basic commodity" },
          { name: "Tech Gadgets", basePrice: 30, volatility: 0.5, currentPrice: 30, owned: 0, description: "Consumer electronics" },
          { name: "Rare Gems", basePrice: 50, volatility: 0.7, currentPrice: 50, owned: 0, description: "Precious stones" },
          { name: "Art Pieces", basePrice: 75, volatility: 0.4, currentPrice: 75, owned: 0, description: "Fine art" },
          { name: "Gold Bars", basePrice: 100, volatility: 0.8, currentPrice: 100, owned: 0, description: "Bullion" },
          { name: "Electronics", basePrice: 45, volatility: 0.4, currentPrice: 45, owned: 0, description: "Components" }
        ],
        lastUpdate: Date.now()
      },
      crafting: {
        recipes: [
          { name: "Premium Coffee", ingredients: [{ name: "Coffee Beans", amount: 3 }], value: 60, description: "Artisanal blend" },
          { name: "Tech Bundle", ingredients: [{ name: "Tech Gadgets", amount: 2 }, { name: "Electronics", amount: 1 }], value: 120, description: "Complete tech kit" },
          { name: "Luxury Set", ingredients: [{ name: "Rare Gems", amount: 1 }, { name: "Gold Bars", amount: 1 }], value: 200, description: "High-end collection" }
        ]
      },
      tasks: [
        { word: "INVEST", reward: 5 },
        { word: "TRADE", reward: 5 },
        { word: "PROFIT", reward: 5 },
        { word: "MARKET", reward: 5 },
        { word: "WEALTH", reward: 5 },
        { word: "CAPITAL", reward: 8 },
        { word: "DIVIDEND", reward: 8 },
        { word: "PORTFOLIO", reward: 8 }
      ],
      currentTask: null,
      prestige: 0,
      gameStartTime: Date.now(),
      // Cooldowns in seconds
      cooldowns: {
        task: 0,
        freelance: 0,
        quickTrade: 0,
        partTime: 0,
        stock: 0,
        consulting: 0,
        crypto: 0
      },
      // Cooldown durations in seconds
      cooldownDurations: {
        task: 10,
        freelance: 15,
        quickTrade: 5,
        partTime: 30,
        stock: 45,
        consulting: 60,
        crypto: 90
      }
    };

    // DOM elements
    const moneyEl = document.getElementById('money');
    const incomePerSecEl = document.getElementById('incomePerSec');
    const incomeProgressEl = document.getElementById('incomeProgress');
    const messageEl = document.getElementById('message');
    const taskAreaEl = document.getElementById('taskArea');
    const taskInstructionEl = document.getElementById('taskInstruction');
    const taskInputEl = document.getElementById('taskInput');
    const taskSubmitBtn = document.getElementById('taskSubmit');
    
    // Stats elements
    const statsInvestmentsEl = document.getElementById('statsInvestments');
    const statsStartupsEl = document.getElementById('statsStartups');
    const statsTotalIncomeEl = document.getElementById('statsTotalIncome');

    // Cooldown display elements
    const taskCooldownEl = document.getElementById('taskCooldown');
    const freelanceCooldownEl = document.getElementById('freelanceCooldown');
    const tradeCooldownEl = document.getElementById('tradeCooldown');
    const partTimeCooldownEl = document.getElementById('partTimeCooldown');
    const stockCooldownEl = document.getElementById('stockCooldown');
    const consultingCooldownEl = document.getElementById('consultingCooldown');
    const cryptoCooldownEl = document.getElementById('cryptoCooldown');

    // Button elements
    const taskBtn = document.getElementById('taskBtn');
    const freelanceBtn = document.getElementById('freelanceBtn');
    const investBtn = document.getElementById('investBtn');
    const quickTradeBtn = document.getElementById('quickTradeBtn');
    const partTimeBtn = document.getElementById('partTimeBtn');
    const stockBtn = document.getElementById('stockBtn');
    const consultingBtn = document.getElementById('consultingBtn');
    const cryptoBtn = document.getElementById('cryptoBtn');
    const startupBtn = document.getElementById('startupBtn');

    // Formatting functions
    function formatMoney(n) { 
      if (n >= 1000000) return '$' + (n / 1000000).toFixed(2) + 'M';
      if (n >= 1000) return '$' + (n / 1000).toFixed(2) + 'K';
      return '$' + Math.round(n).toLocaleString(); 
    }

    function formatIncome(n) { 
      return '+' + formatMoney(n) + '/sec'; 
    }

    function formatTime(seconds) {
      if (seconds <= 0) return 'Ready';
      if (seconds < 60) return seconds + 's';
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return mins + 'm ' + secs + 's';
    }

    // Create animated background particles
    function createParticles() {
      const container = document.getElementById('bgParticles');
      for (let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        particle.className = 'bg-particle';
        
        const size = Math.random() * 20 + 5;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${Math.random() * 100}%`;
        particle.style.animationDelay = `${Math.random() * 20}s`;
        particle.style.animationDuration = `${20 + Math.random() * 20}s`;
        
        const colors = ['rgba(255, 255, 255, 0.2)', 'rgba(16, 185, 129, 0.1)', 'rgba(59, 130, 246, 0.1)'];
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
        
        container.appendChild(particle);
      }
    }

    // Update cooldowns
    function updateCooldowns() {
      const now = Date.now();
      
      // Update cooldown displays
      taskCooldownEl.textContent = formatTime(state.cooldowns.task);
      freelanceCooldownEl.textContent = formatTime(state.cooldowns.freelance);
      tradeCooldownEl.textContent = formatTime(state.cooldowns.quickTrade);
      partTimeCooldownEl.textContent = formatTime(state.cooldowns.partTime);
      stockCooldownEl.textContent = formatTime(state.cooldowns.stock);
      consultingCooldownEl.textContent = formatTime(state.cooldowns.consulting);
      cryptoCooldownEl.textContent = formatTime(state.cooldowns.crypto);
      
      // Enable/disable buttons based on cooldowns
      taskBtn.disabled = state.cooldowns.task > 0;
      freelanceBtn.disabled = state.cooldowns.freelance > 0;
      quickTradeBtn.disabled = state.cooldowns.quickTrade > 0;
      partTimeBtn.disabled = state.cooldowns.partTime > 0;
      stockBtn.disabled = state.cooldowns.stock > 0 || state.money < 25;
      consultingBtn.disabled = state.cooldowns.consulting > 0;
      cryptoBtn.disabled = state.cooldowns.crypto > 0 || state.money < 50;
      
      // Add/remove cooldown-active class
      taskBtn.classList.toggle('cooldown-active', state.cooldowns.task > 0);
      freelanceBtn.classList.toggle('cooldown-active', state.cooldowns.freelance > 0);
      quickTradeBtn.classList.toggle('cooldown-active', state.cooldowns.quickTrade > 0);
      partTimeBtn.classList.toggle('cooldown-active', state.cooldowns.partTime > 0);
      stockBtn.classList.toggle('cooldown-active', state.cooldowns.stock > 0);
      consultingBtn.classList.toggle('cooldown-active', state.cooldowns.consulting > 0);
      cryptoBtn.classList.toggle('cooldown-active', state.cooldowns.crypto > 0);
    }

    // Update UI
    function updateUI() {
      moneyEl.textContent = formatMoney(state.money);
      
      // Calculate total income
      state.totalIncomePerSec = 
        (state.investments * state.investmentsYieldPerSec) + 
        (state.startups * state.startupYieldPerSec) +
        state.buildings.reduce((sum, b) => sum + (b.owned * b.incomePerMin / 60), 0);
      
      incomePerSecEl.textContent = formatIncome(state.totalIncomePerSec);
      
      // Update stats overlay
      statsInvestmentsEl.textContent = state.investments;
      statsStartupsEl.textContent = state.startups;
      statsTotalIncomeEl.textContent = formatMoney(state.totalIncomePerSec);
      
      // Update button states
      investBtn.disabled = state.money < state.investmentCost;
      investBtn.innerHTML = `<span>üìä Invest</span><span class="btn-cooldown">${formatMoney(state.investmentCost)}</span>`;
      
      startupBtn.disabled = state.money < state.startupCost;
      startupBtn.innerHTML = `<span>üöÄ Startup</span><span class="btn-cooldown">${formatMoney(state.startupCost)}</span>`;
      
      // Show/hide opportunity tiers
      document.getElementById('highTierOpportunities').style.display = 
        state.money > 100 ? 'block' : 'none';
        
      // Update all grids
      renderMarket();
      renderBuildings();
      renderAssets();
      renderRecipes();
      
      // Update cooldowns
      updateCooldowns();
    }

    // Show message with animation
    function showMessage(text, type = 'info') {
      messageEl.textContent = text;
      messageEl.className = `message-${type}`;
      
      setTimeout(() => {
        messageEl.style.opacity = '0';
        messageEl.style.transform = 'translateY(-10px)';
      }, 3000);
    }

    // Set cooldown for a button
    function setCooldown(type) {
      state.cooldowns[type] = state.cooldownDurations[type];
    }

    // Task system
    function startTask() {
      if (state.cooldowns.task > 0) return;
      
      setCooldown('task');
      state.currentTask = state.tasks[Math.floor(Math.random() * state.tasks.length)];
      taskInstructionEl.textContent = `Type: "${state.currentTask.word}"`;
      taskAreaEl.style.display = 'block';
      taskInputEl.value = '';
      taskInputEl.focus();
      updateCooldowns();
    }

    // Initialize task submit
    taskSubmitBtn.addEventListener('click', () => {
      if (!state.currentTask) return;
      
      if (taskInputEl.value.toUpperCase() === state.currentTask.word) {
        state.money += state.currentTask.reward;
        showMessage(`Task completed! +${formatMoney(state.currentTask.reward)}`, 'success');
        taskAreaEl.style.display = 'none';
        updateUI();
      } else {
        showMessage('Incorrect! Try again.', 'error');
      }
    });

    taskInputEl.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        taskSubmitBtn.click();
      }
    });

    // Button event handlers with cooldowns
    taskBtn.addEventListener('click', startTask);

    freelanceBtn.addEventListener('click', () => {
      if (state.cooldowns.freelance > 0) return;
      
      setCooldown('freelance');
      const reward = 15 + Math.floor(Math.random() * 10);
      state.money += reward;
      showMessage(`Freelance project completed! +${formatMoney(reward)}`, 'success');
      updateUI();
    });

    investBtn.addEventListener('click', () => {
      if (state.money >= state.investmentCost) {
        state.money -= state.investmentCost;
        state.investments++;
        state.investmentCost = Math.floor(state.investmentCost * 1.15);
        showMessage(`Investment purchased! Passive income increased.`, 'success');
        updateUI();
      }
    });

    quickTradeBtn.addEventListener('click', () => {
      if (state.cooldowns.quickTrade > 0) return;
      
      setCooldown('quickTrade');
      if (state.money >= 5) {
        const risk = Math.random();
        if (risk > 0.3) {
          const gain = Math.floor(Math.random() * 20) + 5;
          state.money += gain;
          showMessage(`Quick trade successful! +${formatMoney(gain)}`, 'success');
        } else {
          const loss = Math.floor(Math.random() * 15) + 5;
          state.money = Math.max(0, state.money - loss);
          showMessage(`Trade failed! -${formatMoney(loss)}`, 'error');
        }
        updateUI();
      }
    });

    partTimeBtn.addEventListener('click', () => {
      if (state.cooldowns.partTime > 0) return;
      
      setCooldown('partTime');
      state.money += 10;
      showMessage(`Part-time shift completed! +${formatMoney(10)}`, 'success');
      updateUI();
    });

    stockBtn.addEventListener('click', () => {
      if (state.cooldowns.stock > 0) return;
      
      setCooldown('stock');
      if (state.money >= 25) {
        const risk = Math.random();
        if (risk > 0.4) {
          const gain = Math.floor(Math.random() * 50) + 10;
          state.money += gain;
          showMessage(`Stock investment paid off! +${formatMoney(gain)}`, 'success');
        } else {
          const loss = Math.floor(Math.random() * 40) + 10;
          state.money = Math.max(0, state.money - loss);
          showMessage(`Stock market crash! -${formatMoney(loss)}`, 'error');
        }
        updateUI();
      }
    });

    consultingBtn.addEventListener('click', () => {
      if (state.cooldowns.consulting > 0) return;
      
      setCooldown('consulting');
      state.money += 30;
      showMessage(`Consulting contract! +${formatMoney(30)}`, 'success');
      updateUI();
    });

    cryptoBtn.addEventListener('click', () => {
      if (state.cooldowns.crypto > 0) return;
      
      setCooldown('crypto');
      if (state.money >= 50) {
        const risk = Math.random();
        if (risk > 0.5) {
          const gain = Math.floor(Math.random() * 100) + 50;
          state.money += gain;
          showMessage(`Crypto mooned! +${formatMoney(gain)}`, 'success');
        } else {
          const loss = Math.floor(Math.random() * 75) + 25;
          state.money = Math.max(0, state.money - loss);
          showMessage(`Crypto crashed! -${formatMoney(loss)}`, 'error');
        }
        updateUI();
      }
    });

    startupBtn.addEventListener('click', () => {
      if (state.money >= state.startupCost) {
        state.money -= state.startupCost;
        state.startups++;
        state.startupCost = Math.floor(state.startupCost * 1.25);
        showMessage(`Startup launched! +${formatMoney(state.startupYieldPerSec)}/sec passive income`, 'success');
        updateUI();
      }
    });

    // Market functions
    function renderMarket() {
      const grid = document.getElementById('marketGrid');
      if (!grid) return;
      
      grid.innerHTML = state.market.items.map(item => `
        <div class="grid-item">
          <div class="grid-header">
            <div class="grid-name">${item.name}</div>
            <div class="grid-price">${formatMoney(item.currentPrice)}</div>
          </div>
          <div class="grid-details">
            <div>${item.description}</div>
            <div>Owned: ${item.owned}</div>
          </div>
          <div class="grid-actions">
            <button class="small-btn buy-btn" onclick="buyMarketItem('${item.name}')" 
              ${state.money < item.currentPrice ? 'disabled' : ''}>
              Buy
            </button>
            <button class="small-btn sell-btn" onclick="sellMarketItem('${item.name}')" 
              ${item.owned === 0 ? 'disabled' : ''}>
              Sell
            </button>
          </div>
        </div>
      `).join('');
    }

    function buyMarketItem(name) {
      const item = state.market.items.find(x => x.name === name);
      if (!item || state.money < item.currentPrice) return;
      
      state.money -= item.currentPrice;
      item.owned++;
      showMessage(`Bought ${item.name} for ${formatMoney(item.currentPrice)}`, 'success');
      updateUI();
    }

    function sellMarketItem(name) {
      const item = state.market.items.find(x => x.name === name);
      if (!item || item.owned === 0) return;
      
      state.money += item.currentPrice;
      item.owned--;
      showMessage(`Sold ${item.name} for ${formatMoney(item.currentPrice)}`, 'success');
      updateUI();
    }

    // Update market prices
    function updateMarketPrices() {
      const now = Date.now();
      const timeDiff = (now - state.market.lastUpdate) / 1000;
      
      if (timeDiff > 10) {
        state.market.items.forEach(item => {
          const change = (Math.random() - 0.5) * 2 * item.volatility;
          item.currentPrice = Math.max(1, Math.floor(item.currentPrice * (1 + change)));
        });
        state.market.lastUpdate = now;
        renderMarket();
      }
    }

    // Building functions
    function renderBuildings() {
      const grid = document.getElementById('buildingGrid');
      if (!grid) return;
      
      grid.innerHTML = state.buildings.map(building => `
        <div class="grid-item">
          <div class="grid-header">
            <div class="grid-name">${building.name}</div>
            <div class="grid-price">${formatMoney(building.cost)}</div>
          </div>
          <div class="grid-details">
            <div>${building.description}</div>
            <div>Income: ${formatMoney(building.incomePerMin)}/min</div>
          </div>
          <div class="grid-details">
            <div>Owned: ${building.owned}</div>
            <div>Total: ${formatMoney(building.owned * building.incomePerMin)}/min</div>
          </div>
          <div class="grid-actions">
            <button class="small-btn buy-btn" onclick="buyBuilding('${building.name}')" 
              ${state.money < building.cost ? 'disabled' : ''}>
              Buy
            </button>
          </div>
        </div>
      `).join('');
    }

    function buyBuilding(name) {
      const building = state.buildings.find(x => x.name === name);
      if (!building || state.money < building.cost) return;
      
      state.money -= building.cost;
      building.owned++;
      building.cost = Math.floor(building.cost * 1.2);
      showMessage(`Built ${building.name}! +${formatMoney(building.incomePerMin)}/min income`, 'success');
      updateUI();
    }

    // Asset functions
    function renderAssets() {
      const grid = document.getElementById('assetGrid');
      if (!grid) return;
      
      grid.innerHTML = state.assets.map(asset => `
        <div class="grid-item">
          <div class="grid-header">
            <div class="grid-name">${asset.name}</div>
            <div class="grid-price">${formatMoney(asset.cost)}</div>
          </div>
          <div class="grid-details">
            <div>${asset.description}</div>
            <div>Growth: ${(asset.growthPerMin * 100).toFixed(1)}%/min</div>
          </div>
          <div class="grid-details">
            <div>Owned: ${asset.owned}</div>
            <div>Value: ${formatMoney(asset.owned * asset.cost)}</div>
          </div>
          <div class="grid-actions">
            <button class="small-btn buy-btn" onclick="buyAsset('${asset.name}')" 
              ${state.money < asset.cost ? 'disabled' : ''}>
              Invest
            </button>
          </div>
        </div>
      `).join('');
    }

    function buyAsset(name) {
      const asset = state.assets.find(x => x.name === name);
      if (!asset || state.money < asset.cost) return;
      
      state.money -= asset.cost;
      asset.owned++;
      asset.cost = Math.floor(asset.cost * 1.15);
      showMessage(`Invested in ${asset.name}!`, 'success');
      updateUI();
    }

    // Crafting functions
    function renderRecipes() {
      const grid = document.getElementById('recipeGrid');
      if (!grid) return;
      
      grid.innerHTML = state.crafting.recipes.map(recipe => {
        const canCraft = recipe.ingredients.every(ing => {
          const item = state.market.items.find(x => x.name === ing.name);
          return item && item.owned >= ing.amount;
        });
        
        return `
          <div class="grid-item">
            <div class="grid-header">
              <div class="grid-name">${recipe.name}</div>
              <div class="grid-price">${formatMoney(recipe.value)}</div>
            </div>
            <div class="grid-details">
              <div>${recipe.description}</div>
            </div>
            <div class="grid-details">
              <div>Ingredients:</div>
              <div>${recipe.ingredients.map(ing => `${ing.name} x${ing.amount}`).join(', ')}</div>
            </div>
            <div class="grid-actions">
              <button class="small-btn buy-btn" onclick="craftItem('${recipe.name}')" 
                ${!canCraft ? 'disabled' : ''}>
                Craft
              </button>
            </div>
          </div>
        `;
      }).join('');
    }

    function craftItem(name) {
      const recipe = state.crafting.recipes.find(x => x.name === name);
      if (!recipe) return;
      
      // Check ingredients
      for (const ing of recipe.ingredients) {
        const item = state.market.items.find(x => x.name === ing.name);
        if (!item || item.owned < ing.amount) {
          showMessage(`Not enough ${ing.name}!`, 'error');
          return;
        }
      }
      
      // Consume ingredients
      for (const ing of recipe.ingredients) {
        const item = state.market.items.find(x => x.name === ing.name);
        item.owned -= ing.amount;
      }
      
      // Add money
      state.money += recipe.value;
      showMessage(`Crafted ${recipe.name}! +${formatMoney(recipe.value)}`, 'success');
      updateUI();
    }

    // Cooldown reduction loop
    function cooldownLoop() {
      const now = Date.now();
      
      // Reduce all cooldowns by 1 second
      Object.keys(state.cooldowns).forEach(key => {
        if (state.cooldowns[key] > 0) {
          state.cooldowns[key]--;
        }
      });
      
      updateCooldowns();
      setTimeout(cooldownLoop, 1000);
    }

    // Passive income loop
    function passiveIncomeLoop() {
      const income = state.totalIncomePerSec;
      if (income > 0) {
        state.money += income;
        const progress = Math.min(100, (income * 100) / 5);
        incomeProgressEl.style.width = `${progress}%`;
      }
      updateUI();
      setTimeout(passiveIncomeLoop, 1000);
    }

    // Market update loop
    function marketUpdateLoop() {
      updateMarketPrices();
      setTimeout(marketUpdateLoop, 1000);
    }

    // Asset growth loop
    function assetGrowthLoop() {
      state.assets.forEach(asset => {
        if (asset.owned > 0) {
          const growth = asset.owned * asset.cost * (asset.growthPerMin / 60);
          state.money += growth;
        }
      });
      setTimeout(assetGrowthLoop, 60000); // Every minute
    }

    // Initialize game
    function init() {
      createParticles();
      updateUI();
      cooldownLoop();
      passiveIncomeLoop();
      marketUpdateLoop();
      assetGrowthLoop();
    }

    // Start the game
    init();
  </script>
</body>
</html>